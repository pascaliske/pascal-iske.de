language: node_js
node_js:
  - '11'
  - '10'
cache:
  yarn: true
  directories:
    - "~/.cache"
install:
  - if [[ "$TRAVIS_PULL_REQUEST_BRANCH" == *"greenkeeper"* ]]; then yarn install; else yarn install --frozen-lockfile; fi
script:
  - yarn run lint
  - yarn run check
  - yarn run e2e
  - yarn run build:app --progress false --base-href https://$PROD_DOMAIN
  - yarn run build:server --progress false
  - yarn run build:cfn
  - yarn run build:prerender
  - yarn run bundlewatch
after_deploy:
  - yarn run report:generate
  - yarn run report:upload
  - yarn run sentry:commits
deploy:
  provider: firebase
  token:
    secure: xxPFmbu41iRKXilPyWD86CjtoBMk8bXRGlxNCtNNTIGSAqH2L39lgACcG2tweebnuVdKv0q3hpkjONuxPtIFzRJSc9OE1sszv3XR3MzVzWJhW0GiD+u1nqPVl1ZBbG+EcLumgWNH2CPRjb4xff9nDp/YK4GoVnnfVE+mQueAfY1cNgMdjnL+RGJazrnwhAwmMJe771B4DRtc4UknCmsxHWATdiAlcB34qifxXx51AV0KfnIB5dp6I8+Tb+nsjJ8iFM1ST7y1aNWBxJcZR8qrAl1AsO/gtytqyRqdN0jChfVw2ISiwxGCj7w+LrTsec7mT9gnfNAmgyHwTkSE0r7HRn/NAm29ZsGB31xSdyZQt8q3uhCAg4uP0W5NVlqzUOu2hJ3p7NuFeMp3heGe8XKbSx8fpl4nAdRRzVx4HoN3pOvS0E6WgDtiOeie593tx/6g7RLI4IBgYAMyCwzynsi9T1E5VkOzCgjX1E5X99e6Vy5qoqob+O9xWsSKEA0p7xnW6e8crABJDSd8zhkrKok5y07ly9RY59Rs53iB2011FdqV69zkGbOvss5qMK4Huf8v5S1TvyJCe6wAg+E/iOfsr2viX4XZPc4nE+R2CXwDIhmgUFFzKE3c4B0oxHE385ixN1nwSkHFxSE6AtYG8QIsrLiV67fsf9eOoeQUiCTG4QU=
  skip_cleanup: true
  on:
    tags: true
    branch: master
    node: 11
env:
  global:
    - secure: QY+1MYVMPURyBBojv89X2CFMpXTIHPDaDgscT4D3ONm5pEeQLU1TNG9IQWcJzlCJb3xpwibROYCFo8cwwnSmGK0zapFRJaceAXtXwY6RwCtBpUw4AbPpI1zJb1ch+Gj3glHEH2T6TY0LbyGa5ZWdeW8Ppwo7u5X++W9F+kLcp+z+jAXvEeVynZ4aE9rgz+j7DdJrNzVGelCQNBGBlns4vyTdJxLfjSHzg58F5Yzrbn9PshtV9imMMkYdYVOTulTuNbEKDYltUKpASrT4Nz5eEV6k5l+VtqL6GCmB2pM0vUtI5Z6BciWBRePm0UiGpYUGqO+Wd3D+c95r5RP6j3W7sNIhYCItScGuQuUGlg219qJW9nSYZ6VISpX24v59PBr8wOyJEr14AlwtohFylm5gXiqYsthdHXOV7IEODanzcrht43gF7GGpQ8OZb5bw5bWL9euJ72BqEG+5CQAnGrM2L3yjVYjdOwSSqGK1uJvbv0t5+TZI3bAMFdHVG5oJFpj1nudgmBHgt715HVP1jTayPdd23S97tfd7Um8r6eKKFfh/0x7fFW4K2kvPzx8qr972uF5LpzuO1BGU82XDf0nm1AH8kNXvfFuOeniC05SEvpcSC4GgzfZWap3eOds7HNvPJXmKlJMBpdm+Hvgx70BN0oGKJlfRIqWm+H21c3Sybbs=
    - secure: FVK0wexU71vn/EGT7SBABuTFheiPMEAxa4KOW/qG/1NQVmkV5NMYRGbvuPJ17G1222St9AksPfSQoMEJKF/N7Wc4dhAJbKdXV3c7RAHHZbQlkhcAGIwfbcmjloj+RKOFjgMEHSR7peKF5qgwFKNXD8xWeF6f9AFAdmwYk/KLK9bCiiY7CdzBt6VQfX6kIRJRfi4Lqd0KXgR4inYgeU1kBd/vM+N/T/4uHtn0p4N5fZ2C0W6cO8EEtdjh0XRYfPFliGNUGo09JmoyarxqZruj3N9L/xkF49798hUtvWJQRrZjFo72In111UAWlxUsD+7Fo29wYUbUM/Ip2rkIBJBgwaODMTgToSnsNbk9c1YZXAjxBnFsHUx+Si91btLNd4Tc7cR3QoTlxXEizHcEbH68IPd8FQl5JSuoQd+tHIe44GRtHZ3fj1pRBQvuZWwd1GzRRY1wBSOWkZvtib1AI0TAN2h4SGl6gRIFhDAT76o/nX6eo/OXcAD7RdJDpijgNT5MWUqz2mV4kYlC5D+N0alq5g8APdwt/y5nhOmt1hO7AAhqPf1q3nQZrjGRoLAA9iGgwTKkwSDQTZ2fme/Py8c9D9E1J/1riXQEUNH5Col2YZAPSXT3sZQ+OTmS47t/e1RzM/oxDch1zF6e+eAGGKletZycCHvadBwL92pFDre/PNg=
    - secure: 0eTARZMX6N4T6vp0PW9o7wKGUrAuuwQNEfjLgkEIquOTW6WkViE0LNBhTQMHrX1Kmqd2fOIaBCJJTcdz2+GMZoVI64vL9nC6zyJsipcROzZwLJstX6nc73w78T/2zu69AjPrRFnnhQ7P0wCNnZgi769VMqsxEMB2Cxn2T81n51ZPzY5MyAeKJQjqtJtmtc6GcGtkrDsgYwRYdrjtKPAeB51QuD1I9sU1H+0HAFaLD3CaCmG7ubA/BDAMIJEdj0gco5kIu6WShkeV56TMpZgOOUmPPhtzaceQrV+xtmH/psfF5EOLOsVXRrqXxbfhcatpvCYpRXoB7tXDx05egPKZimjZlDQRkcd/ritLZz2AdGcKJb44Bj1NbYnb3vGVOyCP5CsA0LOlQPq5iTIE8593pYHt3h5N02I+1MzskqhfxxJ1CWcpR1Z5OfQYrJ+TWgCLCBlZyPKHpVm0DsH6mDueRmaSWeFVxIOvZHx8Ga6SJWqqp34nnGuaYa+9WXdCx9KzgcbSTP0OsL1WSwpJy6yShQhatT2MFT3BZ1r1v6xOWO6j8jo+rwrvflYcW4xMMop3PQFPLlWBcgmDgR23kU4FR9a9Kbq4URDP2EWxyldeGRDxnQxY98CRMwu5sNtQSK79IG3ooGfWNKY0SUKjVQZSORG4sd+z+MjL8Mzhoerhdjw=
    - secure: qWUP7IRKlv7FF55+zuBs8cbjGcvelmluQ2eAGzhTDPXm/wEbalW3yFActM2vO29UGGhx4SobUH6OA6Fxyg+4B6bTIYrWVvoR9fVxMha5QihHujU3e9g932GDwI1qsfys5q1e505rKM1tLhYS55N+Q1MCVPIhRXcY2shymqvUvzhdOXuaVznuxs8PgmyHuEgSb+zhuSMnm3GR2KOiy+Shq02Wu9ZHhNmUDqs+vKai6ZJdK00weBbq0a/AQcoBjbdvNuPMrV+ZPE7skuvvjjp/6SOKpKBR/JKxFEtdMIo3OBQlix+HxBb2n8lGkZNzogOqwBTeH+5/yJyOdvwvl6AcW84z+ZyGRnCRyHH27812HT71JvZDh/LiU1wh83e9N19XF7Mp5KmfzTIY/RXogz+a8ZeE2btMAPnSVnabxYjTXHKZrqLnSk2HOtxzBZDX99iguBfATA3nEsblpIPPbEV8A/h550sLGWa9hvZSZJnzEDkrCtsOCMxu3N8ABgEU4+jKE49Uw1EGGmWRW58Lr6UkNR2l7ye/t1o2REr3L3hfuldVuSFye5PQ4j5vrmZPDEAmXhQAXuPG5laKHdtfsiCcpVXry6c/0QS6UH8YJStLWxCWHjhCuF8WONTIji0yIENqcgBi9w6F0FauVhz/g6EHiWx1dKLvva2ss3yAhH/CtmY=
    - secure: 2MK4fulcoBYTFuoN2SzXYIHnDSIc5hkMw3j49sM8N+G64/ikztYSB5PHjbwOW8nASzLOgX2w1suHis8cwBkcG9KP6+bUol0PcxYCIW6cjiTD8yBQowXe+R4SxaQ2TxIXTpTkG4zLNoGSrFwICe9/ZBBBpWtD2/kPI8V3S+Q39TXmpUXP1sMA6t8u4rt9RDJKKj2XI8aIVfZYkLB5hTGoS+wtFSXgXFZ31GA1f56hIRVIii627RHWicebtkTZIoralKCXBaSWEPXseW6kide3YGfsK8Rzz6qGWBbqEQQEpLxgQUxzXYASF3fimJiLV1Y+7Jl+wQkzFjSIK3GfezaW/k/opUpMQ+waCIyhTcMry9MjkiVpvILG8czHdzy3mFj7CFeJKtIXwDmofdBA9xnsWtoodW7KOpPqUOG42nPvrFwojyDGxPyV0aGJ9rCeRX0D4vi7C7wg66g0AD0PaSKLP9FyLI5nWYruPAJctBz4xtldEix37vWQt1b9/eWv8IaUCA2ijYL1+DSD8uk1NIN5JPitTWWDq58zhRe3mBzFSWnACOKkoi6GYbpBbd8iv7ptuoIWB505a0Dn+hQMh/rxQ52K9q/mBJ3RZublUIQqUtXVwnuOgYjwLaIrYXkgeKlLm5jiYtFc6eBKQ/RS0Tswrst3s/R4rZsyELOeFJj9rf4=
    - secure: HEh/Y9EGXzXE0TYLhO0gA4wVXzYbM9dgr+labe7Ym5czeeiSbXvAgb+RTkCURL3m18Ul6bQwZ0pdNNiBCVpJ/iHBOXZ1MG4KP9MoYLs0qK7ugKvSpYJAmu5QWu0MxVObWX6xPEWWWTW5TWKdSyjeh8kKu1tL2m1l5MS0WS099GFqN3Hk4FmdQM1GP2wrTqBbTQwOGyIrQVVkqsI92voxJvZiZfDzvzPlKp+8Lvp1JQ7TX1P55Om19ob22rCrV2DbMYAxIYaZRfJyw8ycIUAxhXKLSBagTncnDnfeSwGvzeBvnOj8cHH/B2UJnhZGQH0WoIxxNJQ1K/nFEvxCrqmmxrmrTGqiWLsbK/CDCwEG/zKC2URZVUfbXslGFfbiq4AwAgD9g92yJnEXrpZ7qKAuoCMlACLmVre8hndPHZvFUNdEotl7XH0ZjV3Pcpom6oJ3VQtFpTEuUQVFs1PZG/rJSVIDVIHrbxBf3CoSQhfrgRqmQYtJkCIQXsW6EvLvbvLPpnGhCChnvOTmviO4Ke1JNq7j8KvExBmkcv/GwHlEMr/ESItKx9Q8fpe/n6GRQkt+2baAErEMXUPKvTsuOwVTr7SZqyge756fI87uNc1WRLPxJYGusuD4hzSQF/VOHYzp01Prrg4JULsF6Lg7VviHLXptyOHnnidCWVYZXa06efQ=
notifications:
  slack:
    rooms:
      - secure: MeMFT9uhC2UdzZaEjXiloK/yHRlB2Q5k5/gPbxmJim09v7bzu0dEdusNpWuwbZJY13KXF+pXh1UPa1ICuI/GogQ7+waUldsTE7qCWDxyOAPsZIffPvJLlX4Xnkcod/QaJL1xmb9lgqxMy1jUh0gI3qGmqQ5ZQpWTkQtlnoSoQvJd3FqA1MqVl2WvzUq4ok6rAfM29oX1oVGY3Eo/pvaCms0EyL5HZzYSTYe3mUt1lagT7W2pg9IaEyf1rgHIoReoIsL9RRsu2Luj1XJd4rR1+kR3G3ndmcs5s6XtJK+XpworMEwDjSb1y+gl2FQAhwzqvGW+A7k2u7smENtp9r8qr42T7hVB5hRj4IVnuV3VRG/TLGtQ5YTdMKzV4+IUOfXlZtKKTKxhTG36E1nlSaXs9HQcHwbCguPjYf2wDdDoe5GcaJubStCWVCVgBATg5/A7dUfbTaFfxksVNPNy7yID9n04L8N0kyHljaWOs6VHLnIoTNWRRRitsRBaydwMtIZB6ikijSwqp1WSwKvB8mHCpktB4IWLhhURRtIVY7SP/efHXwIMSM25izOKmRneLIJjiTGxNSAgWvmOTWYAgVEofsXGHEvgQPIqAx177cHv6oWJHS4WpxJACsXarMzwDzHeEbfUPelOc6Vae+zuphtnbsjHfp+pePuZk0w1NEDVJwc=
    on_success: change
    on_failure: always
