language: node_js
node_js:
  - '11'
  - '10'
cache: yarn
install:
  - if [[ "$TRAVIS_PULL_REQUEST_BRANCH" == *"greenkeeper"* ]]; then yarn install; else yarn install --frozen-lockfile; fi
script:
  - echo "$TRAVIS_BRANCH"
  - echo "$TRAVIS_PULL_REQUEST"
  - echo "$TRAVIS_PULL_REQUEST_BRANCH"
  - exit 1
  - yarn run lint
  - yarn run check
  - yarn run build:app --progress false --base-href https://$PROD_DOMAIN
  - yarn run build:server --progress false
  - yarn run build:cfn
  - yarn run build:prerender
  - yarn run bundlewatch
after_deploy:
  - yarn run report:generate
  - yarn run report:upload
  - yarn run sentry:commits
deploy:
  provider: firebase
  token:
    secure: xxPFmbu41iRKXilPyWD86CjtoBMk8bXRGlxNCtNNTIGSAqH2L39lgACcG2tweebnuVdKv0q3hpkjONuxPtIFzRJSc9OE1sszv3XR3MzVzWJhW0GiD+u1nqPVl1ZBbG+EcLumgWNH2CPRjb4xff9nDp/YK4GoVnnfVE+mQueAfY1cNgMdjnL+RGJazrnwhAwmMJe771B4DRtc4UknCmsxHWATdiAlcB34qifxXx51AV0KfnIB5dp6I8+Tb+nsjJ8iFM1ST7y1aNWBxJcZR8qrAl1AsO/gtytqyRqdN0jChfVw2ISiwxGCj7w+LrTsec7mT9gnfNAmgyHwTkSE0r7HRn/NAm29ZsGB31xSdyZQt8q3uhCAg4uP0W5NVlqzUOu2hJ3p7NuFeMp3heGe8XKbSx8fpl4nAdRRzVx4HoN3pOvS0E6WgDtiOeie593tx/6g7RLI4IBgYAMyCwzynsi9T1E5VkOzCgjX1E5X99e6Vy5qoqob+O9xWsSKEA0p7xnW6e8crABJDSd8zhkrKok5y07ly9RY59Rs53iB2011FdqV69zkGbOvss5qMK4Huf8v5S1TvyJCe6wAg+E/iOfsr2viX4XZPc4nE+R2CXwDIhmgUFFzKE3c4B0oxHE385ixN1nwSkHFxSE6AtYG8QIsrLiV67fsf9eOoeQUiCTG4QU=
  skip_cleanup: true
  on:
    tags: true
    branch: master
    node: 11
env:
  global:
    - secure: QY+1MYVMPURyBBojv89X2CFMpXTIHPDaDgscT4D3ONm5pEeQLU1TNG9IQWcJzlCJb3xpwibROYCFo8cwwnSmGK0zapFRJaceAXtXwY6RwCtBpUw4AbPpI1zJb1ch+Gj3glHEH2T6TY0LbyGa5ZWdeW8Ppwo7u5X++W9F+kLcp+z+jAXvEeVynZ4aE9rgz+j7DdJrNzVGelCQNBGBlns4vyTdJxLfjSHzg58F5Yzrbn9PshtV9imMMkYdYVOTulTuNbEKDYltUKpASrT4Nz5eEV6k5l+VtqL6GCmB2pM0vUtI5Z6BciWBRePm0UiGpYUGqO+Wd3D+c95r5RP6j3W7sNIhYCItScGuQuUGlg219qJW9nSYZ6VISpX24v59PBr8wOyJEr14AlwtohFylm5gXiqYsthdHXOV7IEODanzcrht43gF7GGpQ8OZb5bw5bWL9euJ72BqEG+5CQAnGrM2L3yjVYjdOwSSqGK1uJvbv0t5+TZI3bAMFdHVG5oJFpj1nudgmBHgt715HVP1jTayPdd23S97tfd7Um8r6eKKFfh/0x7fFW4K2kvPzx8qr972uF5LpzuO1BGU82XDf0nm1AH8kNXvfFuOeniC05SEvpcSC4GgzfZWap3eOds7HNvPJXmKlJMBpdm+Hvgx70BN0oGKJlfRIqWm+H21c3Sybbs=
    - secure: FVK0wexU71vn/EGT7SBABuTFheiPMEAxa4KOW/qG/1NQVmkV5NMYRGbvuPJ17G1222St9AksPfSQoMEJKF/N7Wc4dhAJbKdXV3c7RAHHZbQlkhcAGIwfbcmjloj+RKOFjgMEHSR7peKF5qgwFKNXD8xWeF6f9AFAdmwYk/KLK9bCiiY7CdzBt6VQfX6kIRJRfi4Lqd0KXgR4inYgeU1kBd/vM+N/T/4uHtn0p4N5fZ2C0W6cO8EEtdjh0XRYfPFliGNUGo09JmoyarxqZruj3N9L/xkF49798hUtvWJQRrZjFo72In111UAWlxUsD+7Fo29wYUbUM/Ip2rkIBJBgwaODMTgToSnsNbk9c1YZXAjxBnFsHUx+Si91btLNd4Tc7cR3QoTlxXEizHcEbH68IPd8FQl5JSuoQd+tHIe44GRtHZ3fj1pRBQvuZWwd1GzRRY1wBSOWkZvtib1AI0TAN2h4SGl6gRIFhDAT76o/nX6eo/OXcAD7RdJDpijgNT5MWUqz2mV4kYlC5D+N0alq5g8APdwt/y5nhOmt1hO7AAhqPf1q3nQZrjGRoLAA9iGgwTKkwSDQTZ2fme/Py8c9D9E1J/1riXQEUNH5Col2YZAPSXT3sZQ+OTmS47t/e1RzM/oxDch1zF6e+eAGGKletZycCHvadBwL92pFDre/PNg=
    - secure: 0eTARZMX6N4T6vp0PW9o7wKGUrAuuwQNEfjLgkEIquOTW6WkViE0LNBhTQMHrX1Kmqd2fOIaBCJJTcdz2+GMZoVI64vL9nC6zyJsipcROzZwLJstX6nc73w78T/2zu69AjPrRFnnhQ7P0wCNnZgi769VMqsxEMB2Cxn2T81n51ZPzY5MyAeKJQjqtJtmtc6GcGtkrDsgYwRYdrjtKPAeB51QuD1I9sU1H+0HAFaLD3CaCmG7ubA/BDAMIJEdj0gco5kIu6WShkeV56TMpZgOOUmPPhtzaceQrV+xtmH/psfF5EOLOsVXRrqXxbfhcatpvCYpRXoB7tXDx05egPKZimjZlDQRkcd/ritLZz2AdGcKJb44Bj1NbYnb3vGVOyCP5CsA0LOlQPq5iTIE8593pYHt3h5N02I+1MzskqhfxxJ1CWcpR1Z5OfQYrJ+TWgCLCBlZyPKHpVm0DsH6mDueRmaSWeFVxIOvZHx8Ga6SJWqqp34nnGuaYa+9WXdCx9KzgcbSTP0OsL1WSwpJy6yShQhatT2MFT3BZ1r1v6xOWO6j8jo+rwrvflYcW4xMMop3PQFPLlWBcgmDgR23kU4FR9a9Kbq4URDP2EWxyldeGRDxnQxY98CRMwu5sNtQSK79IG3ooGfWNKY0SUKjVQZSORG4sd+z+MjL8Mzhoerhdjw=
    - secure: qWUP7IRKlv7FF55+zuBs8cbjGcvelmluQ2eAGzhTDPXm/wEbalW3yFActM2vO29UGGhx4SobUH6OA6Fxyg+4B6bTIYrWVvoR9fVxMha5QihHujU3e9g932GDwI1qsfys5q1e505rKM1tLhYS55N+Q1MCVPIhRXcY2shymqvUvzhdOXuaVznuxs8PgmyHuEgSb+zhuSMnm3GR2KOiy+Shq02Wu9ZHhNmUDqs+vKai6ZJdK00weBbq0a/AQcoBjbdvNuPMrV+ZPE7skuvvjjp/6SOKpKBR/JKxFEtdMIo3OBQlix+HxBb2n8lGkZNzogOqwBTeH+5/yJyOdvwvl6AcW84z+ZyGRnCRyHH27812HT71JvZDh/LiU1wh83e9N19XF7Mp5KmfzTIY/RXogz+a8ZeE2btMAPnSVnabxYjTXHKZrqLnSk2HOtxzBZDX99iguBfATA3nEsblpIPPbEV8A/h550sLGWa9hvZSZJnzEDkrCtsOCMxu3N8ABgEU4+jKE49Uw1EGGmWRW58Lr6UkNR2l7ye/t1o2REr3L3hfuldVuSFye5PQ4j5vrmZPDEAmXhQAXuPG5laKHdtfsiCcpVXry6c/0QS6UH8YJStLWxCWHjhCuF8WONTIji0yIENqcgBi9w6F0FauVhz/g6EHiWx1dKLvva2ss3yAhH/CtmY=
    - secure: w2p8r9BgDukrU+5oo82fwdMywzHWDF+GdNL5wWNfkzSdzCFzyRBZ8p3Vj5+nZsY948oWoH6RqnK1zqyYXJrTL3jFu2iEbxpWpct8ljlVVIbz8ZcO09/GNVNXoRjMJeANwzKVzv/i3p9EVHO3EApsPMDD1KeH5YetKJ1bbNyBHzrtHpf1i5VQuwe9C5DR5QAfrasyWhL1CCf4EymtoMy8FtAoR3Vdd0ZlN3Y4kq6LhaOpl3MoUFQYmNg+9kHm4UJXNr9AEOZQ2JHztMeTo6JZ8d5wJ4XynfJH2kLbW9ai2hpyhUsJWZ/QMagoUwDVOEnaQiWLOSXMVOw+G7qDVCUHVD8EmVF/n8VaJXuj8T/gjQXZOJX65eGEa7bNB+aM/SOjmOlevI+Ts2St1FeEH7RgENpIfr9UqDjtu6NirLhcalTaDVwDHwYQrcpHNSA+oOSMZpvYOHhpDAHtpFDZ8AMj/hbRP1DAmJQGzCjRh2I1LSCix7T9HhWDp9Hkmj4JKOKkuGRyXdCSjOvnfWJw+KAHGGp9jJZ+Idl596tUKAGfTrngOMr71GdlkhyIRC2d4B3HJbPlHxDLJTzI7/oJDFz95lflzhMTzgc/2rKfpwOMCqLjYI9QlnzpCCwGzJyMaeBxGamJTsJUh9/h/5pi9exK8KH2BTcDUAFZ1KCOFy0wfQQ=
notifications:
  slack:
    rooms:
      - secure: MeMFT9uhC2UdzZaEjXiloK/yHRlB2Q5k5/gPbxmJim09v7bzu0dEdusNpWuwbZJY13KXF+pXh1UPa1ICuI/GogQ7+waUldsTE7qCWDxyOAPsZIffPvJLlX4Xnkcod/QaJL1xmb9lgqxMy1jUh0gI3qGmqQ5ZQpWTkQtlnoSoQvJd3FqA1MqVl2WvzUq4ok6rAfM29oX1oVGY3Eo/pvaCms0EyL5HZzYSTYe3mUt1lagT7W2pg9IaEyf1rgHIoReoIsL9RRsu2Luj1XJd4rR1+kR3G3ndmcs5s6XtJK+XpworMEwDjSb1y+gl2FQAhwzqvGW+A7k2u7smENtp9r8qr42T7hVB5hRj4IVnuV3VRG/TLGtQ5YTdMKzV4+IUOfXlZtKKTKxhTG36E1nlSaXs9HQcHwbCguPjYf2wDdDoe5GcaJubStCWVCVgBATg5/A7dUfbTaFfxksVNPNy7yID9n04L8N0kyHljaWOs6VHLnIoTNWRRRitsRBaydwMtIZB6ikijSwqp1WSwKvB8mHCpktB4IWLhhURRtIVY7SP/efHXwIMSM25izOKmRneLIJjiTGxNSAgWvmOTWYAgVEofsXGHEvgQPIqAx177cHv6oWJHS4WpxJACsXarMzwDzHeEbfUPelOc6Vae+zuphtnbsjHfp+pePuZk0w1NEDVJwc=
    on_success: change
    on_failure: always
